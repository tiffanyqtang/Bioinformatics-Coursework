{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "da6c72e1-1e4f-4a30-ab98-4c4ff7f92ba7",
   "metadata": {},
   "source": [
    "# Assignment 6\n",
    "## Tiffany Tang\n",
    "## NetID: tt2405"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "19ea988e-6348-4072-979b-c786647b3024",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Female   Male \n",
      "     8     12 \n"
     ]
    }
   ],
   "source": [
    "# sample 20 people from the wh data\n",
    "# Read in the wh data\n",
    "wh <- read.csv(\"weight-height.csv\", header = TRUE)\n",
    "\n",
    "# Randomly sample 20 people from the entire dataset\n",
    "random_sample <- wh[sample(1:nrow(wh), 20), ]\n",
    "\n",
    "# Count the number of males and females in the sample\n",
    "counts1 <- table(random_sample$Gender)\n",
    "print(counts1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "ad5c0775-f2be-4369-9a0e-c986e6790908",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts1\n",
       "X-squared = 0.8, df = 1, p-value = 0.3711\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Perform the Chi Square test\n",
    "# Null hypothesis: half the population in the weight heigh dataset is men\n",
    "chisq1 <- chisq.test(counts1)\n",
    "chisq1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b1089588-c858-4d0b-8ab5-c5a994a3a5f4",
   "metadata": {},
   "source": [
    "First p value is indicates that there is no statistically significant evidence to reject the null hypothesis at common significance levels."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "94a0082c-031c-48f7-a428-7f5579c28bd8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts2\n",
       "X-squared = 0.2, df = 1, p-value = 0.6547\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts3\n",
       "X-squared = 0.8, df = 1, p-value = 0.3711\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# repeating this\n",
    "random_sample <- wh[sample(1:nrow(wh), 20), ]\n",
    "counts2 <- table(random_sample$Gender)\n",
    "chisq2 <- chisq.test(counts2)\n",
    "\n",
    "# number 3\n",
    "random_sample <- wh[sample(1:nrow(wh), 20), ]\n",
    "counts3 <- table(random_sample$Gender)\n",
    "chisq3 <- chisq.test(counts3)\n",
    "\n",
    "# View results \n",
    "chisq2\n",
    "chisq3"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46fb4838-6451-4ce8-b7c8-e75fac4a0695",
   "metadata": {},
   "source": [
    "p values for the 2nd and 3rd time also indicate that there is no statistically significant evidence to reject the null hypothesis\n",
    "\n",
    "**The null hypothesis is accepted.**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d1ac20c3-8da6-44ef-b47f-d2374adb2071",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts40\n",
       "X-squared = 0.9, df = 1, p-value = 0.3428\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 40 \n",
    "random_sample <- wh[sample(1:nrow(wh), 40), ]\n",
    "counts40 <- table(random_sample$Gender)\n",
    "chisq40 <- chisq.test(counts40)\n",
    "chisq40"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "7ecc342b-cd02-43a7-a269-79a737b6cb09",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts60\n",
       "X-squared = 0.6, df = 1, p-value = 0.4386\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 60 \n",
    "random_sample <- wh[sample(1:nrow(wh), 60), ]\n",
    "counts60 <- table(random_sample$Gender)\n",
    "chisq60 <- chisq.test(counts60)\n",
    "chisq60"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ecd16321-370a-48de-ab41-98454be3992e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts80\n",
       "X-squared = 0.2, df = 1, p-value = 0.6547\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 80 \n",
    "random_sample <- wh[sample(1:nrow(wh), 80), ]\n",
    "counts80 <- table(random_sample$Gender)\n",
    "chisq80 <- chisq.test(counts80)\n",
    "chisq80"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "7991ee37-deb8-4960-bfbb-2d5c034445e6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts100\n",
       "X-squared = 0.16, df = 1, p-value = 0.6892\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 100 \n",
    "random_sample <- wh[sample(1:nrow(wh), 100), ]\n",
    "counts100 <- table(random_sample$Gender)\n",
    "chisq100 <- chisq.test(counts100)\n",
    "chisq100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "4636cc4e-23c0-4657-baec-39b7021c1d0b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Female   Male \n",
       "    52     48 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "counts100"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb15370c-e481-41c6-a564-d5760f24ce99",
   "metadata": {},
   "source": [
    "If increasing the sample size to 100 gives a p-value of 0.69, this further confirms that there's no strong evidence to reject the null hypothesis. This means that even with a larger sample, the gender distribution does not significantly deviate from the expected 50:50 ratio of males to females.\n",
    "\n",
    "**The null hypothesis is accepted**"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "af00b61f-e30d-4929-99f0-fdd4831b46a6",
   "metadata": {},
   "source": [
    "### Using the weight-height data create a new population of men and women of total size 3000 and men to women ration of 2. Now repeat a) for a sample size of 20, did you reach significance? If not increase the sample size "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a2535bdb-d94f-4d58-9e5b-a8373ba058f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "wh <- read.csv(\"weight-height.csv\", header = TRUE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "a62d50a6-46b2-4e77-99b7-2b4c9d1b8baa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "\n",
       "Female   Male \n",
       "     7     13 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts_bias\n",
       "X-squared = 1.8, df = 1, p-value = 0.1797\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "\n",
       "Female   Male \n",
       "    37     63 "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/plain": [
       "\n",
       "\tChi-squared test for given probabilities\n",
       "\n",
       "data:  counts_bias\n",
       "X-squared = 6.76, df = 1, p-value = 0.009322\n"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#first I will separate males and females\n",
    "males <- wh[wh$Gender == \"Male\",]\n",
    "females <- wh[wh$Gender == \"Female\", ]\n",
    "\n",
    "# Biased weight height dataset, double the males to females\n",
    "# Total is 3000\n",
    "wh_biased <- rbind(males[sample(nrow(males), 2000, replace = FALSE), ],\n",
    "                   females[sample(nrow(females), 1000, replace = FALSE), ])\n",
    "\n",
    "# create a sample fromt the biased weight height dataset\n",
    "# Sample 20 people\n",
    "\n",
    "random_sample20 <- wh_biased[sample(1:nrow(wh_biased), 20), ]\n",
    "#run chisq on this sample\n",
    "\n",
    "counts_bias <- table(random_sample20$Gender)\n",
    "chisq_bias <- chisq.test(counts_bias)\n",
    "counts_bias\n",
    "chisq_bias\n",
    "\n",
    "# I am going to sample 100 people\n",
    "random_sample100 <- wh_biased[sample(1:nrow(wh_biased), 100), ]\n",
    "\n",
    "#run chisq on this sample\n",
    "counts_bias <- table(random_sample100$Gender)\n",
    "chisq_bias <- chisq.test(counts_bias)\n",
    "counts_bias\n",
    "chisq_bias"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8603013f-0b77-49ba-9c90-669b3e12490b",
   "metadata": {},
   "source": [
    "As you can see above, a sample size of 20 still does not yield a significant p value (0.1). \n",
    "With a sample size of 100 out of a total population of 3000, we were able to see that the sample yielded a p value from the chi square test of .00, which is significant and rejects the null hypothesis that half the population is men."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7b7b5ba4-f271-4b7f-a562-09de7211582a",
   "metadata": {},
   "source": [
    "### Decrease the men to women ratio in increments of 0.1 till you reach 1:1 and repeat a). What sample size do you need for each ratio to reach significance. What does that mean? interpret your results. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "45338494-d1a0-49b8-bf99-b4b56d13a7d8",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Biased Population for Ratio: 2 :1\n",
      "Number of Males: 2000 - Number of Females: 1000 \n",
      "\n",
      "Ratio: 2 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     8     12 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.8, df = 1, p-value = 0.3711\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 2 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    12     28 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 6.4, df = 1, p-value = 0.01141\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 2 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    24     36 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.4, df = 1, p-value = 0.1213\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 2 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    24     56 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 12.8, df = 1, p-value = 0.0003466\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 2 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    36     64 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 7.84, df = 1, p-value = 0.00511\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 2 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    64    136 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 25.92, df = 1, p-value = 3.559e-07\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.9 :1\n",
      "Number of Males: 1965 - Number of Females: 1034 \n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     5     15 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 5, df = 1, p-value = 0.02535\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    13     27 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 4.9, df = 1, p-value = 0.02686\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    27     33 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.6, df = 1, p-value = 0.4386\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    21     59 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 18.05, df = 1, p-value = 2.152e-05\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    31     69 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 14.44, df = 1, p-value = 0.0001447\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.9 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    67    133 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 21.78, df = 1, p-value = 3.058e-06\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.8 :1\n",
      "Number of Males: 1928 - Number of Females: 1071 \n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "    12      8 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.8, df = 1, p-value = 0.3711\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    12     28 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 6.4, df = 1, p-value = 0.01141\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    15     45 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 15, df = 1, p-value = 0.0001075\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    33     47 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.45, df = 1, p-value = 0.1175\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    38     62 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 5.76, df = 1, p-value = 0.0164\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.8 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    72    128 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 15.68, df = 1, p-value = 7.501e-05\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.7 :1\n",
      "Number of Males: 1888 - Number of Females: 1111 \n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     3     17 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 9.8, df = 1, p-value = 0.001745\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "     7     33 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 16.9, df = 1, p-value = 3.94e-05\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    20     40 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 6.6667, df = 1, p-value = 0.009823\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    33     47 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.45, df = 1, p-value = 0.1175\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    39     61 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 4.84, df = 1, p-value = 0.02781\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.7 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    81    119 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 7.22, df = 1, p-value = 0.00721\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.6 :1\n",
      "Number of Males: 1846 - Number of Females: 1153 \n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "    11      9 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.2, df = 1, p-value = 0.6547\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    16     24 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.6, df = 1, p-value = 0.2059\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    23     37 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 3.2667, df = 1, p-value = 0.0707\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    27     53 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 8.45, df = 1, p-value = 0.00365\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    40     60 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 4, df = 1, p-value = 0.0455\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.6 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    67    133 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 21.78, df = 1, p-value = 3.058e-06\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.5 :1\n",
      "Number of Males: 1800 - Number of Females: 1200 \n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "    10     10 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0, df = 1, p-value = 1\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    18     22 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.4, df = 1, p-value = 0.5271\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    28     32 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.26667, df = 1, p-value = 0.6056\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    29     51 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 6.05, df = 1, p-value = 0.01391\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    43     57 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.96, df = 1, p-value = 0.1615\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.5 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    90    110 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2, df = 1, p-value = 0.1573\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.4 :1\n",
      "Number of Males: 1750 - Number of Females: 1250 \n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     9     11 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.2, df = 1, p-value = 0.6547\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    19     21 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.1, df = 1, p-value = 0.7518\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    27     33 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.6, df = 1, p-value = 0.4386\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    37     43 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.45, df = 1, p-value = 0.5023\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    41     59 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 3.24, df = 1, p-value = 0.07186\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.4 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    74    126 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 13.52, df = 1, p-value = 0.000236\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.3 :1\n",
      "Number of Males: 1695 - Number of Females: 1304 \n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "    11      9 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.2, df = 1, p-value = 0.6547\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    17     23 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.9, df = 1, p-value = 0.3428\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    24     36 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.4, df = 1, p-value = 0.1213\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    28     52 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 7.2, df = 1, p-value = 0.00729\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    44     56 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.44, df = 1, p-value = 0.2301\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.3 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    91    109 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.62, df = 1, p-value = 0.2031\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.2 :1\n",
      "Number of Males: 1636 - Number of Females: 1363 \n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "    10     10 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0, df = 1, p-value = 1\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    17     23 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.9, df = 1, p-value = 0.3428\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    25     35 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.6667, df = 1, p-value = 0.1967\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    37     43 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.45, df = 1, p-value = 0.5023\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    41     59 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 3.24, df = 1, p-value = 0.07186\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.2 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    89    111 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.42, df = 1, p-value = 0.1198\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1.1 :1\n",
      "Number of Males: 1571 - Number of Females: 1428 \n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     8     12 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.8, df = 1, p-value = 0.3711\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    22     18 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.4, df = 1, p-value = 0.5271\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    29     31 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.066667, df = 1, p-value = 0.7963\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    33     47 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 2.45, df = 1, p-value = 0.1175\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    48     52 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.16, df = 1, p-value = 0.6892\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1.1 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "    99    101 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.02, df = 1, p-value = 0.8875\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Biased Population for Ratio: 1 :1\n",
      "Number of Males: 1500 - Number of Females: 1500 \n",
      "\n",
      "Ratio: 1 :1 - Sample size: 20 \n",
      "\n",
      "Female   Male \n",
      "     7     13 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.8, df = 1, p-value = 0.1797\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1 :1 - Sample size: 40 \n",
      "\n",
      "Female   Male \n",
      "    21     19 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.1, df = 1, p-value = 0.7518\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1 :1 - Sample size: 60 \n",
      "\n",
      "Female   Male \n",
      "    31     29 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 0.066667, df = 1, p-value = 0.7963\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1 :1 - Sample size: 80 \n",
      "\n",
      "Female   Male \n",
      "    45     35 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 1.25, df = 1, p-value = 0.2636\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1 :1 - Sample size: 100 \n",
      "\n",
      "Female   Male \n",
      "    40     60 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 4, df = 1, p-value = 0.0455\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n",
      "\n",
      "Ratio: 1 :1 - Sample size: 200 \n",
      "\n",
      "Female   Male \n",
      "   114     86 \n",
      "\n",
      "\tChi-squared test for given probabilities\n",
      "\n",
      "data:  counts_bias\n",
      "X-squared = 3.92, df = 1, p-value = 0.04771\n",
      "\n",
      "\n",
      "-----------------------------------------------------------\n"
     ]
    }
   ],
   "source": [
    "# Loop to decrease the men-to-women ratio in increments of 0.1\n",
    "\n",
    "for (ratio in seq(2, 1, by = -0.1)) {\n",
    "  \n",
    "  # Calculate the number of men and women based on the current ratio\n",
    "  total_population <- 3000\n",
    "  men_count <- total_population * (ratio / (1 + ratio))\n",
    "  women_count <- total_population - men_count  # Ensures total is always 3000\n",
    "  \n",
    "  # Create the biased population based on the current men-to-women ratio\n",
    "  wh_biased <- rbind(males[sample(nrow(males), men_count, replace = FALSE), ],\n",
    "                     females[sample(nrow(females), women_count, replace = FALSE), ])\n",
    "    \n",
    "  # Calculate the number of males and females in the biased population\n",
    "  num_males <- sum(wh_biased$Gender == \"Male\")\n",
    "  num_females <- sum(wh_biased$Gender == \"Female\")\n",
    "  \n",
    "  # Print the ratio and the count of males and females in the biased population\n",
    "  cat(\"\\nBiased Population for Ratio:\", round(ratio, 1), \":1\\n\")\n",
    "  cat(\"Number of Males:\", num_males, \"- Number of Females:\", num_females, \"\\n\")\n",
    "  \n",
    "  # Define the sample sizes to test\n",
    "  sample_sizes <- c(20, 40, 60, 80, 100, 200)\n",
    "  \n",
    "  # Loop over the different sample sizes\n",
    "  for (sample_size in sample_sizes) {\n",
    "    \n",
    "    # Take a random sample from the biased population\n",
    "    random_sample <- wh_biased[sample(1:nrow(wh_biased), sample_size), ]\n",
    "    \n",
    "    # Run chi-square test on the gender counts in the sample\n",
    "    counts_bias <- table(random_sample$Gender)\n",
    "    chisq_bias <- chisq.test(counts_bias)\n",
    "    \n",
    "    # Print out the ratio, sample size, and chi-square test result\n",
    "    cat(\"\\nRatio:\", round(ratio, 1), \":1 - Sample size:\", sample_size, \"\\n\")\n",
    "    print(counts_bias)\n",
    "    print(chisq_bias) \n",
    "    cat(\"\\n-----------------------------------------------------------\\n\")\n",
    "  }\n",
    "}\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "95f6b504-d3eb-4ed8-a995-60114cf957ed",
   "metadata": {},
   "source": [
    "Based on the output above... \n",
    "\n",
    "For a ratio of 2:1 (men to wome) a sample size of 40 can produce significance (p value : 0.01)\n",
    "\n",
    "For a ratio of 1.9:1, a sample size of 40 can produce significance (p value : 0.03)\n",
    "\n",
    "For a ratio of 1.8:1, a sample size of 40 can produce significance (p value : 0.01)\n",
    "\n",
    "For a ratio of 1.7:1, a sample size of 20 can produce significance (p value : 0.002)\n",
    "\n",
    "For a ratio of 1.6:1, a sample size of 80 can produce significance (p value: 0.004).\n",
    "\n",
    "For a ratio of 1.5:1, a sample size of 80 can produce significance (p value : 0.01)\n",
    "\n",
    "For a ratio of 1.4:1, a sample size of 200 can produce significance (p value : 0.0002)\n",
    "\n",
    "For a ratio of 1.3:1, a sample size of 80 can produce significance (p value : 0.003)\n",
    "\n",
    "For a ratio of 1.2:1, we were not able to produce significance with the sample sizes.\n",
    "\n",
    "For a ratio of 1.1:1,  we were not able to produce significance with the sample sizes.\n",
    "\n",
    "For a ratio of 1:1, a sample size of 100 can produce significance (p value : 0.05)\n",
    "\n",
    "\n",
    "Vour results illustrate how varying the men-to-women ratio in your sample affects the ability to achieve statistical significance in a Chi-square test. Higher ratios makes it more likely to detect significant differences as there is a greater skew between genders; for instance. At a 1:1 ratio, significance can still be observed, suggesting that even with equal representation, a sample can reveal differences. However, ratios below 1.5:1, it becomes less likely to produce significant results indicating that as gender ratios become more equal, larger samples are essential to detect meaningful differences. At a 1:1 ratio, significance can still be observed with a sample of 20 (p = 0.03), suggesting that even with equal representation a smaller sample may not be representative of the whole population. Along with this, a smaller sample makes it more likely to produce significant results as each individual carries more weight (eg. in a sample of 5 one individual has more sway than a sample of 50). "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db9620ba-225d-4cfc-a846-85f413c2ec15",
   "metadata": {},
   "source": [
    "### Based on this, if you could randomly sample from the population of NY (maybe you manage to get a list of all residents) how many people do we need to sample in NYC (population 8 million) for a reliable estimate of males/females in the city ?(hint men to women ratio is around 1.07 in NYC)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d11efa3e-8d7c-4ab1-804f-7689dabe5747",
   "metadata": {},
   "source": [
    "We probably want a larger sample, I would say at least above 100. The 200 person out of 3000 seemed to represent the group as a whole well, so I would use that ratio to sample NYC. I would want a sample of 53,333 people. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "6002e513-b12f-400f-8b68-874268201db4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1] 533333.3\n"
     ]
    }
   ],
   "source": [
    "x = 200/3000\n",
    "sample = 8000000 * x\n",
    "print(sample)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1fa9a6a2-ea57-4051-8baf-6c409ee54d13",
   "metadata": {},
   "source": [
    "### *Based on this, if you could randomly sample from the populationof NY (maybe you manage to get a list of all residents) how many people do we need to sample in NYC (population 8 million) for a reliable estimate of males/females in the city ?*\n",
    "\n",
    "So if 100/6,000 produces statistical significance for the biased weight height data set, then we can use that proportion to find the sample size for the population of NY. \n",
    "\n",
    "The sample size needed is around 133,333. (see below)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "8a1266ff-3e94-4e73-985f-1d8749ac27ad",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "133333.333333333"
      ],
      "text/latex": [
       "133333.333333333"
      ],
      "text/markdown": [
       "133333.333333333"
      ],
      "text/plain": [
       "[1] 133333.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "prop <- 100/6000\n",
    "sample_size <- prop * 8000000\n",
    "sample_size"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "b5f699bf-dc96-4283-ab5b-ad6cd1c8f72a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<table class=\"dataframe\">\n",
       "<caption>A data.frame: 6 × 9</caption>\n",
       "<thead>\n",
       "\t<tr><th></th><th scope=col>Gene</th><th scope=col>aboral.1</th><th scope=col>aboral.2</th><th scope=col>aboral.3</th><th scope=col>aboral.4</th><th scope=col>oral.1</th><th scope=col>oral.2</th><th scope=col>oral.3</th><th scope=col>oral.4</th></tr>\n",
       "\t<tr><th></th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>\n",
       "</thead>\n",
       "<tbody>\n",
       "\t<tr><th scope=row>1</th><td>ML087114a</td><td>  2.822659</td><td>  7.984582</td><td>  1.712278</td><td>  0.9837522</td><td>17974.2612</td><td>20852.1073</td><td>42894.6122</td><td>39617.4697</td></tr>\n",
       "\t<tr><th scope=row>2</th><td>ML20265a </td><td>  2.822659</td><td> 13.307637</td><td>  6.849113</td><td> 18.6912920</td><td> 1740.9529</td><td> 1234.0512</td><td> 2117.2286</td><td> 1759.2404</td></tr>\n",
       "\t<tr><th scope=row>3</th><td>ML463533a</td><td>  8.467977</td><td> 20.405043</td><td>  9.417530</td><td> 12.7887787</td><td>  547.3138</td><td>  515.7229</td><td>  692.7338</td><td>  558.5421</td></tr>\n",
       "\t<tr><th scope=row>4</th><td>ML085213a</td><td> 47.044314</td><td> 90.491929</td><td> 42.806957</td><td> 52.1388672</td><td> 1902.3050</td><td> 2200.4900</td><td> 3194.1369</td><td> 2592.0367</td></tr>\n",
       "\t<tr><th scope=row>5</th><td>ML01433a </td><td>212.640300</td><td>333.578090</td><td>415.227479</td><td>471.2173091</td><td>14912.2377</td><td>12982.9991</td><td>22573.6083</td><td>26045.2309</td></tr>\n",
       "\t<tr><th scope=row>6</th><td>ML01248a </td><td>  9.408863</td><td>  4.435879</td><td>  7.705252</td><td> 13.7725310</td><td>  443.7184</td><td>  430.1302</td><td>  473.2055</td><td>  367.9020</td></tr>\n",
       "</tbody>\n",
       "</table>\n"
      ],
      "text/latex": [
       "A data.frame: 6 × 9\n",
       "\\begin{tabular}{r|lllllllll}\n",
       "  & Gene & aboral.1 & aboral.2 & aboral.3 & aboral.4 & oral.1 & oral.2 & oral.3 & oral.4\\\\\n",
       "  & <chr> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl> & <dbl>\\\\\n",
       "\\hline\n",
       "\t1 & ML087114a &   2.822659 &   7.984582 &   1.712278 &   0.9837522 & 17974.2612 & 20852.1073 & 42894.6122 & 39617.4697\\\\\n",
       "\t2 & ML20265a  &   2.822659 &  13.307637 &   6.849113 &  18.6912920 &  1740.9529 &  1234.0512 &  2117.2286 &  1759.2404\\\\\n",
       "\t3 & ML463533a &   8.467977 &  20.405043 &   9.417530 &  12.7887787 &   547.3138 &   515.7229 &   692.7338 &   558.5421\\\\\n",
       "\t4 & ML085213a &  47.044314 &  90.491929 &  42.806957 &  52.1388672 &  1902.3050 &  2200.4900 &  3194.1369 &  2592.0367\\\\\n",
       "\t5 & ML01433a  & 212.640300 & 333.578090 & 415.227479 & 471.2173091 & 14912.2377 & 12982.9991 & 22573.6083 & 26045.2309\\\\\n",
       "\t6 & ML01248a  &   9.408863 &   4.435879 &   7.705252 &  13.7725310 &   443.7184 &   430.1302 &   473.2055 &   367.9020\\\\\n",
       "\\end{tabular}\n"
      ],
      "text/markdown": [
       "\n",
       "A data.frame: 6 × 9\n",
       "\n",
       "| <!--/--> | Gene &lt;chr&gt; | aboral.1 &lt;dbl&gt; | aboral.2 &lt;dbl&gt; | aboral.3 &lt;dbl&gt; | aboral.4 &lt;dbl&gt; | oral.1 &lt;dbl&gt; | oral.2 &lt;dbl&gt; | oral.3 &lt;dbl&gt; | oral.4 &lt;dbl&gt; |\n",
       "|---|---|---|---|---|---|---|---|---|---|\n",
       "| 1 | ML087114a |   2.822659 |   7.984582 |   1.712278 |   0.9837522 | 17974.2612 | 20852.1073 | 42894.6122 | 39617.4697 |\n",
       "| 2 | ML20265a  |   2.822659 |  13.307637 |   6.849113 |  18.6912920 |  1740.9529 |  1234.0512 |  2117.2286 |  1759.2404 |\n",
       "| 3 | ML463533a |   8.467977 |  20.405043 |   9.417530 |  12.7887787 |   547.3138 |   515.7229 |   692.7338 |   558.5421 |\n",
       "| 4 | ML085213a |  47.044314 |  90.491929 |  42.806957 |  52.1388672 |  1902.3050 |  2200.4900 |  3194.1369 |  2592.0367 |\n",
       "| 5 | ML01433a  | 212.640300 | 333.578090 | 415.227479 | 471.2173091 | 14912.2377 | 12982.9991 | 22573.6083 | 26045.2309 |\n",
       "| 6 | ML01248a  |   9.408863 |   4.435879 |   7.705252 |  13.7725310 |   443.7184 |   430.1302 |   473.2055 |   367.9020 |\n",
       "\n"
      ],
      "text/plain": [
       "  Gene      aboral.1   aboral.2   aboral.3   aboral.4    oral.1     oral.2    \n",
       "1 ML087114a   2.822659   7.984582   1.712278   0.9837522 17974.2612 20852.1073\n",
       "2 ML20265a    2.822659  13.307637   6.849113  18.6912920  1740.9529  1234.0512\n",
       "3 ML463533a   8.467977  20.405043   9.417530  12.7887787   547.3138   515.7229\n",
       "4 ML085213a  47.044314  90.491929  42.806957  52.1388672  1902.3050  2200.4900\n",
       "5 ML01433a  212.640300 333.578090 415.227479 471.2173091 14912.2377 12982.9991\n",
       "6 ML01248a    9.408863   4.435879   7.705252  13.7725310   443.7184   430.1302\n",
       "  oral.3     oral.4    \n",
       "1 42894.6122 39617.4697\n",
       "2  2117.2286  1759.2404\n",
       "3   692.7338   558.5421\n",
       "4  3194.1369  2592.0367\n",
       "5 22573.6083 26045.2309\n",
       "6   473.2055   367.9020"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "data <- read.csv(\"diffexpr-results_no_p.csv\", row.names = 1, header = TRUE) # Read in data\n",
    "head(data)# just to look"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "013bf2ed-0fd1-4ba6-a32d-29c24412a8ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "2456"
      ],
      "text/latex": [
       "2456"
      ],
      "text/markdown": [
       "2456"
      ],
      "text/plain": [
       "[1] 2456"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "p_values <- apply(data, 1, function(row) { #use lapply to apply this to each row\n",
    "  t.test(as.numeric(row[c(\"aboral.1\", \"aboral.2\", \"aboral.3\", \"aboral.4\")]), # Aboral data\n",
    "         as.numeric(row[c(\"oral.1\", \"oral.2\", \"oral.3\", \"oral.4\")]))$p.value # Oral data\n",
    "})\n",
    "sum(p_values < 0.05, na.rm = TRUE) #sum up all values that are less than 0.05"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "961617bd-d0e0-4eb7-8476-4c1003b66c0f",
   "metadata": {},
   "outputs": [],
   "source": [
    "adjusted_p_10 <- p.adjust(p_values, method = \"fdr\") #use FDR as the adjustment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "1835f7db-7d96-4c31-9489-6d07240f0ce1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "48"
      ],
      "text/latex": [
       "48"
      ],
      "text/markdown": [
       "48"
      ],
      "text/plain": [
       "[1] 48"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Select genes that meet the FDR threshold (10%)\n",
    "# Omit NA rows\n",
    "significant_genes_10 <- na.omit(data[adjusted_p_10 <= 0.10, ])\n",
    "\n",
    "# How many genes?\n",
    "n_genes_10 <- nrow(significant_genes_10)\n",
    "n_genes_10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "059c3d0d-9ce9-44b8-bcd2-67ecedfbb8fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "664"
      ],
      "text/latex": [
       "664"
      ],
      "text/markdown": [
       "664"
      ],
      "text/plain": [
       "[1] 664"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Select for 20%\n",
    "# Omit NA rows\n",
    "significant_genes_20 <- na.omit(data[adjusted_p_10 <= 0.20, ])\n",
    "\n",
    "# How many genes?\n",
    "n_genes_20 <- nrow(significant_genes_20)\n",
    "n_genes_20"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "f195b8a0-ed75-4224-bfd6-66ab9fc83a38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "3"
      ],
      "text/latex": [
       "3"
      ],
      "text/markdown": [
       "3"
      ],
      "text/plain": [
       "[1] 3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Use Bonferroni\n",
    "adjusted_bon <- p.adjust(p_values, method = \"bonferroni\") #use bonferroni as the adjustment\n",
    "\n",
    "# How many genes?\n",
    "genes_bon <- na.omit(data[adjusted_bon <= 0.05, ]) # Omit NA\n",
    "genes_bon <- nrow(genes_bon)\n",
    "genes_bon"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "18d613d6-5d6b-41b1-87de-9b6b8ba2d199",
   "metadata": {},
   "source": [
    "### *If you used the expression values, which genes would you have picked if you did not use any significance tests (t-tests) ? Justify your answer with some logic (not by a p-value calculation)*\n",
    "\n",
    "If I were to select genes based on expression values alone, without performing any statistical significance tests, I would look for genes where the expression levels between the two groups (aboral vs. oral) show substantial and consistent differences. For example, in the case of the gene ML087114 (first row), the aboral expressions are [2.822, 7.982, 1.712, 0.984], while the oral expressions are [17972, 20852, 42894, 39617]. Here, the oral expression values are thousands of times greater than the aboral values, suggesting a drastic differential expression. My selection criterion would focus on genes where the expression values between the groups exhibit such large, biologically meaningful differences, indicating potential regulation or functional divergence between aboral and oral conditions. This approach relies on the assumption that extreme differences in raw expression likely reflect underlying biological significance, even in the absence of formal statistical testing."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0a2e2a8d-41b4-439f-a66d-0e0fe36fc3d5",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.4.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
